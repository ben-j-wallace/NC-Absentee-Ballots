setwd("~/ncabsenteeballots")
setwd(~/"ncabsenteeballots")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
requests <- read_csv("data/absentee_requests.csv")
returns <- read_csv("data/absentee_returns.csv")
requests <- requests %>%
select(county_name, party_desc, ethncity_desc, race_desc, gender_desc, age_range, request_week_num, group_count)
requests <- requests %>%
rename(party = party_desc,
count = group_count,
county = county_name,
ethnicity = ethncity_desc,
race = race_desc,
gender = gender_desc,
age = age_range,
week = request_week_num)
requests$ethnicity = recode(requests$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic" , `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated")
requests$race = recode(requests$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns <- returns %>%
select(county_desc, race, ethnicity, ballot_rtn_status) %>%
rename(county = county_desc,
rtn_status = ballot_rtn_status)
returns$ethnicity = recode(returns$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic", `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns$race = recode(returns$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
reqtotals <- requests %>%
filter(ethnicity != "hispanic")
reqtotals$race <- fct_other(reqtotals$race, keep = c("White", "Black", "Asian"), other_level = "Other")
reqtotals <- reqtotals %>%
group_by(race) %>%
summarise(reqtotal = sum(count))
rettotals <- returns %>%
group_by(rtn_status)
rettotalsaccpt <- rettotals %>%
filter(rtn_status = "ACCEPTED", ethnicity != "hispanic")
reqtotals <- requests %>%
filter(ethnicity != "hispanic")
reqtotals$race <- fct_other(reqtotals$race, keep = c("White", "Black", "Asian"), other_level = "Other")
reqtotals <- reqtotals %>%
group_by(race) %>%
summarise(reqtotal = sum(count))
rettotals <- returns %>%
group_by(rtn_status)
rettotalsaccpt <- rettotals %>%
filter(rtn_status == "ACCEPTED", ethnicity != "hispanic")
rettotalsnaccpt <- rettotals %>%
filter(rtn_status != "ACCEPTED", ethnicity != "hispanic")
rettotalsaccpt$race <- fct_other(rettotals$race, keep = c("White", "Black", "Asian"), other_level = "Other")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
requests <- read_csv("data/absentee_requests.csv")
returns <- read_csv("data/absentee_returns.csv")
requests <- requests %>%
select(county_name, party_desc, ethncity_desc, race_desc, gender_desc, age_range, request_week_num, group_count)
requests <- requests %>%
rename(party = party_desc,
count = group_count,
county = county_name,
ethnicity = ethncity_desc,
race = race_desc,
gender = gender_desc,
age = age_range,
week = request_week_num)
requests$ethnicity = recode(requests$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic" , `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated")
requests$race = recode(requests$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns <- returns %>%
select(county_desc, race, ethnicity, ballot_rtn_status) %>%
rename(county = county_desc,
rtn_status = ballot_rtn_status)
returns$ethnicity = recode(returns$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic", `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns$race = recode(returns$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
#requests <- requests %>%
#filter(county == "WATAUGA")
#returns <- returns %>%
#filter(county == "WATAUGA")
reqtotals <- requests %>%
filter(ethnicity != "hispanic")
reqtotals$race <- fct_other(reqtotals$race, keep = c("White", "Black", "Asian"), other_level = "Other")
reqtotals <- reqtotals %>%
group_by(race) %>%
summarise(reqtotal = sum(count))
rettotals <- returns %>%
group_by(rtn_status)
rettotalsaccpt <- rettotals %>%
filter(rtn_status == "ACCEPTED", ethnicity != "hispanic")
rettotalsnaccpt <- rettotals %>%
filter(rtn_status != "ACCEPTED", ethnicity != "hispanic")
rettotalsaccpt$race <- fct_other(rettotals$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsaccpt$race <- fct_other(rettotalsaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsnaccpt$race <- fct_other(rettotalsnaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsaccpt <- rettotalsaccpt %>%
group_by(race) %>%
summarise(rettotal = n())
rettotalsnaccpt <- rettotalsnaccpt %>%
group_by(race) %>%
summarise(rettotal = n())
totalsaccpt <- dplyr::bind_cols(reqtotals, rettotals)
View(rettotalsaccpt)
View(rettotalsnaccpt)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
requests <- read_csv("data/absentee_requests.csv")
returns <- read_csv("data/absentee_returns.csv")
requests <- requests %>%
select(county_name, party_desc, ethncity_desc, race_desc, gender_desc, age_range, request_week_num, group_count)
requests <- requests %>%
rename(party = party_desc,
count = group_count,
county = county_name,
ethnicity = ethncity_desc,
race = race_desc,
gender = gender_desc,
age = age_range,
week = request_week_num)
requests$ethnicity = recode(requests$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic" , `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated")
requests$race = recode(requests$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns <- returns %>%
select(county_desc, race, ethnicity, ballot_rtn_status) %>%
rename(county = county_desc,
rtn_status = ballot_rtn_status)
returns$ethnicity = recode(returns$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic", `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns$race = recode(returns$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
#requests <- requests %>%
#filter(county == "WATAUGA")
#returns <- returns %>%
#filter(county == "WATAUGA")
reqtotals <- requests %>%
filter(ethnicity != "hispanic")
reqtotals$race <- fct_other(reqtotals$race, keep = c("White", "Black", "Asian"), other_level = "Other")
reqtotals <- reqtotals %>%
group_by(race) %>%
summarise(reqtotal = sum(count))
rettotals <- returns %>%
group_by(rtn_status)
rettotalsaccpt <- rettotals %>%
filter(rtn_status == "ACCEPTED", ethnicity != "hispanic")
rettotalsnaccpt <- rettotals %>%
filter(rtn_status != "ACCEPTED", ethnicity != "hispanic")
rettotalsaccpt$race <- fct_other(rettotalsaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsnaccpt$race <- fct_other(rettotalsnaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsaccpt <- rettotalsaccpt %>%
group_by(race) %>%
summarise(`Accepted` = n())
rettotalsnaccpt <- rettotalsnaccpt %>%
group_by(race) %>%
summarise(`Not Accepted` = n())
totals <- dplyr::bind_cols(reqtotals, rettotalsaccpt, rettotalsnaccpt)
View(totals)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
requests <- read_csv("data/absentee_requests.csv")
returns <- read_csv("data/absentee_returns.csv")
requests <- requests %>%
select(county_name, party_desc, ethncity_desc, race_desc, gender_desc, age_range, request_week_num, group_count)
requests <- requests %>%
rename(party = party_desc,
count = group_count,
county = county_name,
ethnicity = ethncity_desc,
race = race_desc,
gender = gender_desc,
age = age_range,
week = request_week_num)
requests$ethnicity = recode(requests$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic" , `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated")
requests$race = recode(requests$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns <- returns %>%
select(county_desc, race, ethnicity, ballot_rtn_status) %>%
rename(county = county_desc,
rtn_status = ballot_rtn_status)
returns$ethnicity = recode(returns$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic", `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns$race = recode(returns$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
#requests <- requests %>%
#filter(county == "WATAUGA")
#returns <- returns %>%
#filter(county == "WATAUGA")
reqtotals <- requests %>%
filter(ethnicity != "hispanic")
reqtotals$race <- fct_other(reqtotals$race, keep = c("White", "Black", "Asian"), other_level = "Other")
reqtotals <- reqtotals %>%
group_by(race) %>%
summarise(reqtotal = sum(count))
rettotals <- returns %>%
group_by(rtn_status)
rettotalsaccpt <- rettotals %>%
filter(rtn_status == "ACCEPTED", ethnicity != "hispanic")
rettotalsnaccpt <- rettotals %>%
filter(rtn_status != "ACCEPTED", ethnicity != "hispanic")
rettotalsaccpt$race <- fct_other(rettotalsaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsnaccpt$race <- fct_other(rettotalsnaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsaccpt <- rettotalsaccpt %>%
group_by(race) %>%
summarise(`Accepted` = n())
rettotalsnaccpt <- rettotalsnaccpt %>%
group_by(race) %>%
summarise(`Not Accepted` = n())
totals <- dplyr::bind_cols(reqtotals, rettotalsaccpt, rettotalsnaccpt) %>%
select(race, reqtotal, `Accepted`, `Not Accepted`)
View(totals)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
requests <- read_csv("data/absentee_requests.csv")
returns <- read_csv("data/absentee_returns.csv")
requests <- requests %>%
select(county_name, party_desc, ethncity_desc, race_desc, gender_desc, age_range, request_week_num, group_count)
requests <- requests %>%
rename(party = party_desc,
count = group_count,
county = county_name,
ethnicity = ethncity_desc,
race = race_desc,
gender = gender_desc,
age = age_range,
week = request_week_num)
requests$ethnicity = recode(requests$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic" , `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated")
requests$race = recode(requests$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns <- returns %>%
select(county_desc, race, ethnicity, ballot_rtn_status) %>%
rename(county = county_desc,
rtn_status = ballot_rtn_status)
returns$ethnicity = recode(returns$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic", `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns$race = recode(returns$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
#requests <- requests %>%
#filter(county == "WATAUGA")
#returns <- returns %>%
#filter(county == "WATAUGA")
reqtotals <- requests %>%
filter(ethnicity != "hispanic")
reqtotals$race <- fct_other(reqtotals$race, keep = c("White", "Black", "Asian"), other_level = "Other")
reqtotals <- reqtotals %>%
group_by(race) %>%
summarise(reqtotal = sum(count))
rettotals <- returns %>%
group_by(rtn_status)
rettotalsaccpt <- rettotals %>%
filter(rtn_status == "ACCEPTED", ethnicity != "hispanic")
rettotalsnaccpt <- rettotals %>%
filter(rtn_status != "ACCEPTED", ethnicity != "hispanic")
rettotalsaccpt$race <- fct_other(rettotalsaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsnaccpt$race <- fct_other(rettotalsnaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsaccpt <- rettotalsaccpt %>%
group_by(race) %>%
summarise(`Accepted` = n())
rettotalsnaccpt <- rettotalsnaccpt %>%
group_by(race) %>%
summarise(`Not Accepted` = n())
totals <- dplyr::bind_cols(reqtotals, rettotalsaccpt, rettotalsnaccpt) %>%
select(race, reqtotal, `Accepted`, `Not Accepted`) %>%
rename(Race = race, `Requested` = reqtotal)
View(totals)
View(totals)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
requests <- read_csv("data/absentee_requests.csv")
returns <- read_csv("data/absentee_returns.csv")
requests <- requests %>%
select(county_name, party_desc, ethncity_desc, race_desc, gender_desc, age_range, request_week_num, group_count)
requests <- requests %>%
rename(party = party_desc,
count = group_count,
county = county_name,
ethnicity = ethncity_desc,
race = race_desc,
gender = gender_desc,
age = age_range,
week = request_week_num)
requests$ethnicity = recode(requests$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic" , `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated")
requests$race = recode(requests$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns <- returns %>%
select(county_desc, race, ethnicity, ballot_rtn_status) %>%
rename(county = county_desc,
rtn_status = ballot_rtn_status)
returns$ethnicity = recode(returns$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic", `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns$race = recode(returns$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
#requests <- requests %>%
#filter(county == "WATAUGA")
#returns <- returns %>%
#filter(county == "WATAUGA")
reqtotals <- requests %>%
filter(ethnicity != "hispanic")
reqtotals$race <- fct_other(reqtotals$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsaccpt <- rettotals %>%
filter(rtn_status == "ACCEPTED", ethnicity != "hispanic")
rettotalsnaccpt <- rettotals %>%
filter(rtn_status != "ACCEPTED", ethnicity != "hispanic")
rettotalsaccpt$race <- fct_other(rettotalsaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsnaccpt$race <- fct_other(rettotalsnaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
totals2 <- dplyr::bind_cols(reqtotals, rettotalsaccpt, rettotalsnaccpt) %>%
select(race, reqtotal, `Accepted`, `Not Accepted`) %>%
rename(Race = race, `Requested` = reqtotal) %>%
group_by(race) %>%
summarise(`Accepted` = n(),
`Not Accepted` = n(),
reqtotal = sum(count))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
requests <- read_csv("data/absentee_requests.csv")
returns <- read_csv("data/absentee_returns.csv")
requests <- requests %>%
select(county_name, party_desc, ethncity_desc, race_desc, gender_desc, age_range, request_week_num, group_count)
requests <- requests %>%
rename(party = party_desc,
count = group_count,
county = county_name,
ethnicity = ethncity_desc,
race = race_desc,
gender = gender_desc,
age = age_range,
week = request_week_num)
requests$ethnicity = recode(requests$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic" , `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated")
requests$race = recode(requests$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns <- returns %>%
select(county_desc, race, ethnicity, ballot_rtn_status) %>%
rename(county = county_desc,
rtn_status = ballot_rtn_status)
returns$ethnicity = recode(returns$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic", `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns$race = recode(returns$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
#requests <- requests %>%
#filter(county == "WATAUGA")
#returns <- returns %>%
#filter(county == "WATAUGA")
reqtotals <- requests %>%
filter(ethnicity != "hispanic")
reqtotals$race <- fct_other(reqtotals$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsaccpt <- rettotals %>%
filter(rtn_status == "ACCEPTED", ethnicity != "hispanic")
rettotalsnaccpt <- rettotals %>%
filter(rtn_status != "ACCEPTED", ethnicity != "hispanic")
rettotalsaccpt$race <- fct_other(rettotalsaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsnaccpt$race <- fct_other(rettotalsnaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
totals2 <- dplyr::bind_cols(reqtotals, rettotalsaccpt, rettotalsnaccpt)
View(rettotalsaccpt)
totals2 <- dplyr::bind_rows(reqtotals, rettotalsaccpt, rettotalsnaccpt) %>%
select(race, reqtotal, `Accepted`, `Not Accepted`)
?mutate
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
requests <- read_csv("data/absentee_requests.csv")
returns <- read_csv("data/absentee_returns.csv")
requests <- requests %>%
select(county_name, party_desc, ethncity_desc, race_desc, gender_desc, age_range, request_week_num, group_count)
requests <- requests %>%
rename(party = party_desc,
count = group_count,
county = county_name,
ethnicity = ethncity_desc,
race = race_desc,
gender = gender_desc,
age = age_range,
week = request_week_num)
requests$ethnicity = recode(requests$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic" , `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated")
requests$race = recode(requests$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns <- returns %>%
select(county_desc, race, ethnicity, ballot_rtn_status) %>%
rename(county = county_desc,
rtn_status = ballot_rtn_status)
returns$ethnicity = recode(returns$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic", `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns$race = recode(returns$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
#requests <- requests %>%
#filter(county == "WATAUGA")
#returns <- returns %>%
#filter(county == "WATAUGA")
reqtotals <- requests %>%
filter(ethnicity != "hispanic")
reqtotals$race <- fct_other(reqtotals$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsaccpt <- rettotals %>%
filter(rtn_status == "ACCEPTED", ethnicity != "hispanic")
rettotalsnaccpt <- rettotals %>%
filter(rtn_status != "ACCEPTED", ethnicity != "hispanic")
rettotalsaccpt$race <- fct_other(rettotalsaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
rettotalsnaccpt$race <- fct_other(rettotalsnaccpt$race, keep = c("White", "Black", "Asian"), other_level = "Other")
View(rettotalsaccpt)
totals2 <- dplyr::bind_rows(reqtotals, rettotalsaccpt, rettotalsnaccpt)
View(totals2)
View(reqtotals)
View(requests)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
requests <- read_csv("data/absentee_requests.csv")
returns <- read_csv("data/absentee_returns.csv")
requests <- requests %>%
select(county_name, party_desc, ethncity_desc, race_desc, gender_desc, age_range, request_week_num, group_count)
requests <- requests %>%
rename(party = party_desc,
count = group_count,
county = county_name,
ethnicity = ethncity_desc,
race = race_desc,
gender = gender_desc,
age = age_range,
week = request_week_num)
requests$ethnicity = recode(requests$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic" , `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated")
requests$race = recode(requests$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns <- returns %>%
select(county_desc, race, ethnicity, ballot_rtn_status) %>%
rename(county = county_desc,
rtn_status = ballot_rtn_status)
returns$ethnicity = recode(returns$ethnicity, `NOT HISPANIC or NOT LATINO` = "nonhispanic", `HISPANIC or LATINO` = "hispanic", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
returns$race = recode(returns$race, `BLACK or AFRICAN AMERICAN` = "Black", `INDIAN AMERICAN or ALASKA NATIVE` = "indianamerican", `TWO or MORE RACES` = "multiracial", `WHITE` = "White", `UNDESIGNATED` = "undesignated", `ASIAN` = "Asian", `NATIVE HAWAIIAN or PACIFIC ISLANDER` = "pacislander", `OTHER` = "Other")
#requests <- requests %>%
#filter(county == "WATAUGA")
#returns <- returns %>%
#filter(county == "WATAUGA")
View(requests)
